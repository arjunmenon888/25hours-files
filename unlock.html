<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="robots" content="noindex,nofollow" />
<title>25hours Hotel One Central â€” Document Vault</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cpath fill='%23000' d='M20 28v-6a12 12 0 1 1 24 0v6h2a6 6 0 0 1 6 6v18a6 6 0 0 1-6 6H18a6 6 0 0 1-6-6V34a6 6 0 0 1 6-6h2zm6 0h12v-6a6 6 0 1 0-12 0v6z'/%3E%3C/svg%3E">

<style>
  :root{
    --bg1:#0e0f12;          /* deep charcoal */
    --bg2:#1b1e24;          /* card bg */
    --muted:#aeb4c0;        /* secondary text */
    --acc:#ff4d4f;          /* accent (warm, energetic) */
    --acc-2:#ffd166;        /* soft accent */
    --ring: rgba(255,77,79,.45);
    --radius:18px;
    --shadow: 0 10px 30px rgba(0,0,0,.35);
  }

  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0;
    font:16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    color:#fff;
    background:
      radial-gradient(1200px 800px at 10% -10%, #222630 0%, transparent 60%),
      radial-gradient(1200px 800px at 110% 110%, #1a1f27 0%, transparent 60%),
      linear-gradient(180deg, #0e0f12 0%, #111319 100%);
    display:grid;
    place-items:center;
    padding:24px;
  }

  .wrap{
    width:min(720px, 96vw);
    box-shadow:var(--shadow);
    border-radius:var(--radius);
    background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.08);
    backdrop-filter:saturate(140%) blur(8px);
    position:relative;
    overflow:hidden;
  }

  .ribbon{
    position:absolute; inset:auto -80px  auto  -80px;
    top:-160px; height:280px;
    background: conic-gradient(from -10deg, var(--acc), #ff7a7c, var(--acc), var(--acc-2), #fff, var(--acc-2), var(--acc));
    opacity:.12; filter:blur(60px);
    transform:rotate(-4deg);
    pointer-events:none;
  }

  header{
    padding:28px 28px 0;
    display:flex; align-items:center; gap:16px;
  }
  .logo{
    width:56px; height:56px; border-radius:12px; overflow:hidden;
    display:grid; place-items:center; background:#fff;
  }
  .logo img{ width:100%; height:100%; object-fit:cover }
  .brand h1{ margin:0; font-size:20px; letter-spacing:.2px }
  .brand p{ margin:2px 0 0; color:var(--muted); font-size:13.5px }

  .card{
    padding:26px 28px 30px;
  }

  .badge{
    display:inline-flex; align-items:center; gap:8px;
    background:rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.12);
    color:#e9edf4; font-weight:600; letter-spacing:.3px;
    padding:6px 10px; border-radius:999px; font-size:12px;
  }
  .badge svg{ width:16px; height:16px }

  h2{
    margin:14px 0 6px; font-size:28px;
    letter-spacing:.2px;
  }
  .sub{
    color:var(--muted); margin:0 0 18px; font-size:14.5px;
  }

  form{
    margin-top:8px;
    display:grid; gap:12px;
  }
  label{ font-size:13.5px; color:#e8e9ee }

  .input{
    position:relative;
  }
  input[type="password"], input[type="text"]{
    width:100%; padding:14px 44px 14px 14px;
    border-radius:12px; border:1px solid rgba(255,255,255,.12);
    background:rgba(18,20,26,.8);
    color:#fff; outline:none; font-size:16px;
    transition:border-color .18s, box-shadow .18s, transform .05s;
  }
  input:focus{
    border-color:var(--ring);
    box-shadow:0 0 0 6px rgba(255,77,79,.12);
  }

  .toggle{
    position:absolute; right:8px; top:8px;
    display:inline-flex; align-items:center; gap:6px;
    font-size:12.5px; color:var(--muted);
    background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1);
    padding:6px 8px; border-radius:10px; cursor:pointer; user-select:none;
  }

  button{
    margin-top:6px;
    width:100%; padding:14px 16px; border-radius:12px; border:none;
    background:linear-gradient(180deg, var(--acc), #e63c3f);
    color:#fff; font-weight:700; font-size:16px; letter-spacing:.2px;
    box-shadow:0 6px 18px rgba(230,60,63,.45);
    cursor:pointer;
  }
  button:active{ transform:translateY(1px) }

  .meta{
    display:flex; gap:12px; flex-wrap:wrap;
    margin-top:14px; color:var(--muted); font-size:12.5px;
  }
  .err{
    color:#ffb3b3; min-height:1.2em; margin-top:6px; font-size:13.5px;
  }

  footer{
    padding:18px 28px 26px;
    color:var(--muted); font-size:12.5px;
    display:flex; justify-content:space-between; align-items:center; gap:16px; flex-wrap:wrap;
    border-top:1px solid rgba(255,255,255,.06);
  }
  a{ color:#e7ecff; text-decoration:underline dotted }

  /* Success overlay */
  .veil{
    position:fixed; inset:0; display:none; place-items:center;
    background:rgba(14,15,18,.75); backdrop-filter:blur(4px);
  }
  .veil.on{ display:grid }
  .spinner{
    width:48px; height:48px; border-radius:50%;
    border:4px solid rgba(255,255,255,.15);
    border-top-color:#fff; animation:spin .9s linear infinite;
  }
  @keyframes spin{ to{ transform:rotate(360deg) } }

  /* Shake on error */
  .shake{ animation:shake .3s linear }
  @keyframes shake{
    0%,100%{ transform:translateX(0) }
    20%{ transform:translateX(-6px) }
    40%{ transform:translateX(6px) }
    60%{ transform:translateX(-4px) }
    80%{ transform:translateX(4px) }
  }

  @media (max-width:520px){
    h2{ font-size:24px }
    .brand h1{ font-size:18px }
  }
</style>
</head>
<body>

<div class="wrap" role="main" aria-labelledby="vault-title">
  <div class="ribbon" aria-hidden="true"></div>

  <header>
    <div class="logo" aria-hidden="true">
      <!-- Replace with your real logo URL if you like -->
      <img alt="25hours Logo" src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Placeholder_view_vector.svg">
    </div>
    <div class="brand">
      <h1>25hours Hotel One Central</h1>
      <p>Dubai â€¢ Document Vault</p>
    </div>
  </header>

  <section class="card">
    <span class="badge" aria-hidden="true">
      <!-- lock icon -->
      <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17 8h-1V6a4 4 0 1 0-8 0v2H7a3 3 0 0 0-3 3v7a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-7a3 3 0 0 0-3-3Zm-6 0h2V6a2 2 0 1 0-4 0v2Z"/></svg>
      Secure Access
    </span>

    <h2 id="vault-title">Licenses & Certificates</h2>
    <p class="sub">Enter the access password to view official hotel licenses, permits, and certifications.</p>

    <form id="form" autocomplete="on">
      <label for="pw">Password</label>
      <div class="input" id="input-wrap">
        <input id="pw" name="password" type="password" inputmode="text"
               placeholder="Enter password" aria-required="true" autofocus />
        <span class="toggle" id="toggle">
          <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true"><path fill="currentColor" d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12zm11 4a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/></svg>
          Show
        </span>
      </div>
      <button id="go" type="button" aria-label="Unlock and continue">Unlock &amp; Continue</button>
      <div id="err" class="err" role="alert" aria-live="polite"></div>

      <div class="meta" aria-hidden="true">
        <span>ðŸ”’ AESâ€‘GCM encryption</span>
        <span>ðŸ›¡ PBKDF2â€‘SHA256 key derivation</span>
        <span>â™» Clientâ€‘side decryption</span>
      </div>
    </form>
  </section>

  <footer>
    <div>For authorised recipients only. Access is monitored.</div>
    <div>Security department<a href="mailto:security.onecentral@25hours-hotels.com"></a>security.onecentral@25hours-hotels.com</div>
  </footer>
</div>

<!-- Redirect veil -->
<div class="veil" id="veil" aria-hidden="true">
  <div class="spinner" aria-label="Redirectingâ€¦"></div>
</div>

<script>
/* ---------- UI niceties ---------- */
const pw = document.getElementById('pw');
const go = document.getElementById('go');
const err = document.getElementById('err');
const veil = document.getElementById('veil');
const inputWrap = document.getElementById('input-wrap');

document.getElementById('toggle').addEventListener('click', () => {
  const type = pw.getAttribute('type') === 'password' ? 'text' : 'password';
  pw.setAttribute('type', type);
  document.getElementById('toggle').lastChild.textContent = (type === 'text' ? ' Hide' : ' Show');
});
pw.addEventListener('keydown', e => { if (e.key === 'Enter') go.click(); });

/* ---------- Crypto helpers (must match the Python side) ---------- */
function parseFragment() {
  const hash = location.hash.replace(/^#/, "");
  const params = new URLSearchParams(hash);
  // We expect: v=1&iters=...&salt=...&iv=...&ct=...
  return params;
}
function b64urlToBytes(b64url) {
  const pad = "=".repeat((4 - (b64url.length % 4)) % 4);
  const str = b64url.replace(/-/g, "+").replace(/_/g, "/") + pad;
  const bin = atob(str);
  const out = new Uint8Array(bin.length);
  for (let i = 0; i < bin.length; i++) out[i] = bin.charCodeAt(i);
  return out;
}
async function pbkdf2Key(password, salt, iterations) {
  const enc = new TextEncoder();
  const baseKey = await crypto.subtle.importKey(
    "raw", enc.encode(password), { name: "PBKDF2" }, false, ["deriveKey"]
  );
  return crypto.subtle.deriveKey(
    { name: "PBKDF2", salt, iterations, hash: "SHA-256" },
    baseKey,
    { name: "AES-GCM", length: 256 },
    false,
    ["decrypt"]
  );
}
async function decryptUrl(password, params) {
  const v = params.get("v") || "1";
  if (v !== "1") throw new Error("Unsupported link version");
  const iters = parseInt(params.get("iters") || "250000", 10);
  const salt = b64urlToBytes(params.get("salt"));
  const iv   = b64urlToBytes(params.get("iv"));
  const ct   = b64urlToBytes(params.get("ct"));

  const key = await pbkdf2Key(password, salt, iters);
  const pt  = await crypto.subtle.decrypt({ name: "AES-GCM", iv }, key, ct);
  const dec = new TextDecoder().decode(pt);
  if (!/^https?:\/\//i.test(dec)) throw new Error("Decrypted value is not a URL");
  return dec;
}

/* ---------- Main action ---------- */
go.addEventListener('click', async () => {
  err.textContent = "";
  inputWrap.classList.remove('shake');

  const params = parseFragment();
  if (![...params.keys()].length) {
    err.textContent = "Missing encrypted link. Please use the QR code or the full unlock URL.";
    return;
  }

  const password = pw.value.trim();
  if (!password) {
    err.textContent = "Please enter the password.";
    inputWrap.classList.add('shake');
    return;
  }

  try {
    const url = await decryptUrl(password, params);
    veil.classList.add('on'); // show spinner
    // small delay to let the UI update
    setTimeout(() => window.location.replace(url), 100);
  } catch (e) {
    console.error(e);
    err.textContent = "Invalid password or corrupted link.";
    inputWrap.classList.add('shake');
    pw.select();
  }
});
</script>
</body>
</html>
